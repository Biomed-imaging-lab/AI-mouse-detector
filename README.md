# Анализ поведения лабораторных мышей

Это приложение предоставляет веб-интерфейс для анализа видеэкспериментов над лабораторными мышами. Тип видеоэксперимента: open field (<<открытое поле>>). Входные данные должны выглядеть следующим образом:
![Пример входных данных](docs/images/input.png)

## Возможности

- Обнаружение и отслеживание мыши с помощью YOLO
- Анализ и классификация поведения
- Отслеживание скорости и положения
- Зональный анализ (Центральная, Внутренняя, Средняя и Внешняя зоны)
- Автоматическая генерация графиков
- Выгрузка результатов (данные Excel/CSV и отладочное видео)

## Установка и запуск

### Запуск через Docker

Для запуска приложения через Docker:

1. Установите [Docker](https://docs.docker.com/get-docker/) и [Docker Compose](https://docs.docker.com/compose/install/)

2. Клонируйте репозиторий:
```bash
git clone <URL_репозитория>
cd MouseDetector
```

3. Соберите и запустите контейнер:
```bash
docker-compose up --build
```

4. Откройте веб-браузер и перейдите по адресу:
```
http://localhost:8501
```

Приложение готово к использованию! Все необходимые файлы весов нейронных сетей уже включены в образ.

#### Управление Docker-контейнером

Полезные команды для управления контейнером:

```bash
# Запуск в фоновом режиме
docker-compose up -d

# Остановка контейнера
docker-compose down

# Просмотр логов
docker-compose logs -f

# Перезапуск контейнера
docker-compose restart
```

#### Структура данных

При использовании Docker:
- Загруженные видео сохраняются в папке `uploads/`
- Результаты анализа сохраняются в папке `mouse_data/`
- Эти папки автоматически создаются при первом запуске

### Локальная установка (альтернативный способ)

1. Клонируйте этот репозиторий
2. Установите необходимые зависимости:
```bash
pip install -r requirements.txt
```

## Запуск приложения (для локальной установки)

1. Запустите приложение Streamlit:
```bash
streamlit run app.py
```

2. Откройте веб-браузер и перейдите по URL, указанному в терминале (обычно http://localhost:8501)

## Использование приложения

1. **Загрузка файлов**
   - Загрузите видеофайл (формат MP4 или AVI)
   - Загрузите файл весов YOLO для обнаружения мыши
   - Загрузите файл весов YOLO для анализа поведения

2. **Настройка анализа**
   - Выберите, нужно ли создавать отладочное видео
   - Выберите, нужно ли создавать графики анализа

3. **Запуск анализа**
   - Нажмите кнопку "Запуск" для начала обработки
   - Дождитесь завершения анализа

4. **Просмотр результатов**
   - Просмотр предварительных данных
   - Скачивание полных данных в формате Excel
   - Просмотр отладочного видео (если было создано)
   - Просмотр сгенерированных графиков
   - Скачивание необходимых результатов

## Выходные файлы

Приложение генерирует несколько типов выходных файлов:

- Excel файл с подробными данными анализа
- Отладочное видео, показывающее обнаружение и отслеживание (опционально)
- Различные графики:
  - Траектория движения мыши
  - График скорости во времени
  - Тепловая карта положений
  - Тепловая карта скоростей
  - Гистограммы зонального анализа
  - Графики анализа поведения

## Системные требования

- Docker Engine 20.10+ (для запуска через Docker)
- или Python 3.9+ (для локальной установки)
- Полный список зависимостей см. в файле requirements.txt

## Примечания

- Обработка больших видеофайлов может занять некоторое время
- Убедитесь, что у вас достаточно места на диске для выходных файлов
- При использовании Docker все данные сохраняются в локальных папках `uploads/` и `mouse_data/`
- Не останавливайте контейнер во время обработки видео
- При обновлении страницы в браузере текущие результаты анализа будут потеряны 